// Generated by CoffeeScript 1.6.3
(function() {
  var app, assert, base_url, express, freeport, slumber;

  assert = require('assert');

  express = require('express');

  freeport = require('freeport');

  slumber = require('..');

  base_url = 'http://www.example.com/';

  app = express();

  app.get('/', function(req, res) {
    return res.end('Hello World !');
  });

  describe('Routing', function() {
    var api;
    api = slumber.API(base_url, {});
    describe('#base_url', function() {
      return it('should retrieve a string with base_url of api', function() {
        return assert.equal(api.base_url, base_url);
      });
    });
    describe('one child', function() {
      return it('should retrieve a string with base_url of api with 1 child', function() {
        return assert.equal(api('customers').base_url, "" + base_url + "customers/");
      });
    });
    return describe('two children', function() {
      return it('should retrieve a string with base_url of api with 2 children', function() {
        return assert.equal(api('customers')(42).base_url, "" + base_url + "customers/42/");
      });
    });
  });

  describe('Local Express', function() {
    var api;
    api = null;
    before(function(done) {
      return freeport(function(err, port) {
        return app.listen(port, function() {
          return api = slumber.API("http://localhost:" + port + "/", {}, function() {
            return done();
          });
        });
      });
    });
    return describe('Connection', function() {
      return it('should connect to express and return a string Hello World', function(done) {
        return api.get(function(err, ret) {
          assert.equal(err, null);
          assert.equal(ret, 'Hello World !');
          return done();
        });
      });
    });
  });

}).call(this);
